<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>عرض تقديمي لخدمة "مفقوداتي" المعززة بالذكاء الاصطناعي</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Tajawal', sans-serif;
            background-color: #f8f9fa;
        }
        .flowchart-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            position: relative;
            padding: 1rem;
            background-color: white;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            border: 1px solid #e2e8f0;
            transition: all 0.3s ease-in-out;
            height: 100%;
        }
         .flowchart-step-ai {
            border-left: 5px solid #4CAF50;
         }
        .flowchart-icon {
            font-size: 2.5rem;
            line-height: 1;
            margin-bottom: 0.75rem;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
            height: 250px;
            max-height: 300px;
        }
        .kpi-card {
            background-color: #ffffff;
            border-radius: 12px;
            padding: 24px;
            text-align: center;
            box-shadow: 0 8px 16px rgba(0,0,0,0.05);
            border-left: 5px solid #2196F3;
            transition: transform 0.2s;
            height: 100%; 
        }
        .kpi-card:hover {
            transform: translateY(-5px);
        }
        .comparison-card {
            background-color: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            height: 100%;
        }
        .comparison-card h4 {
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
        }
        .comparison-card .icon {
            font-size: 1.5rem;
            margin-left: 0.5rem;
        }
        .traditional {
            border-top: 4px solid #F44336;
        }
        .ai-enhanced {
            border-top: 4px solid #4CAF50;
        }
        .tab-button.active {
            border-color: #4CAF50;
            color: #4CAF50;
            font-weight: 700;
        }
        .tab-button {
            border-bottom-width: 2px;
            transition: all 0.3s;
        }
        .ai-demo-container {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
        }
        .strategy-card {
            background-color: #ffffff;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.05);
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center; 
            text-align: center;
        }
        .strategy-card p {
            text-align: right; 
        }
        .commercial-card {
             background-color: #ffffff;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            height: 100%;
        }
         .commercial-card h3 {
             border-right: 4px solid #2196F3;
             padding-right: 12px;
         }
        .comparison-point {
            border-right: 3px solid #ccc;
            padding-right: 10px;
            margin-bottom: 10px;
        }
        .ai-point {
            border-right-color: #4CAF50;
            font-weight: 500;
        }
        .traditional-point {
            border-right-color: #F44336;
            font-weight: 500;
        }
    </style>
</head>
<body class="bg-gray-50">

    <div class="container mx-auto p-4 md:p-8">

        <header class="text-center mb-12 py-8 bg-white rounded-xl shadow-lg border border-gray-200">
            <h1 class="4xl md:text-6xl font-extrabold text-[#2196F3]">خدمة "مفقوداتي"</h1>
            <p class="mt-4 text-xl md:text-2xl font-bold text-[#F44336] mb-3">
                 <span class="text-[#2196F3] text-opacity-75">الشعار:</span> حوّل كل هاتف إلى شبكة للبحث عن المفقودات
            </p>
            <p class="text-lg md:text-xl text-gray-600">
                الجيل الجديد من الخدمات المجتمعية: <span style="font-weight: bold; color: #4CAF50;">معززة بالذكاء الاصطناعي</span>
            </p>
        </header>

        <main>
            <!-- 1. تعريف الخدمة، الرؤية، والهدف -->
            <section id="definition" class="mb-16 bg-white p-8 rounded-xl shadow-md">
                <h2 class="text-3xl font-bold text-[#2196F3] mb-8 border-r-4 border-[#2196F3] pr-4 text-right">1. تعريف الخدمة، الرؤية، والهدف</h2>
                
                <div class="mb-8 p-6 bg-blue-50 border-b-4 border-[#2196F3] rounded-lg text-center">
                    <h3 class="text-2xl font-bold text-[#2196F3] mb-2 flex items-center justify-center">
                        <span class="flowchart-icon ml-3">⭐</span> تعريف "مفقوداتي"
                    </h3>
                    <p class="gray-700 leading-relaxed text-lg text-center">
                        "مفقوداتي" هي خدمة وطنية تعتمد على <span style="font-weight: bold;">الرسائل القصيرة (SMS)</span> لإنشاء شبكة تفاعلية وآمنة بين أفراد المجتمع. تتيح الخدمة للمشتركين الإبلاغ عن مقتنياتهم المفقودة، ويتم بث هذه البلاغات بشكل <span style="font-weight: bold;">فوري ومستهدف</span> إلى جميع المشتركين الآخرين داخل نفس النطاق الجغرافي.
                        <br><span style="font-weight: bold; display: block; margin-top: 0.5rem; color: #4CAF50;">شعار الخدمة: حوّل كل هاتف إلى شبكة للبحث عن المفقودات.</span>
                    </p>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="strategy-card border-r-4 border-[#4CAF50]">
                        <div class="text-5xl mb-3 text-[#4CAF50]">🔭</div>
                        <h3 class="xl font-bold text-gray-800 mb-2 w-full text-center">الرؤية (Vision)</h3>
                        <p class="text-gray-600 text-base text-right">
                            أن نكون <span style="font-weight: bold;">المنصة الأولى والأكثر موثوقية</span> للإبلاغ عن المفقودات والموجودات في البلاد عبر أسهل وسيلة تواصل، وهي الرسائل القصيرة.
                        </p>
                    </div>
                    <div class="strategy-card border-r-4 border-[#2196F3]">
                        <div class="text-5xl mb-3 text-[#2196F3]">🎯</div>
                        <h3 class="xl font-bold text-gray-800 mb-2 w-full text-center">الهدف (Goal)</h3>
                        <p class="text-gray-600 text-base text-right">
                            توفير قناة تواصل <span style="font-weight: bold;">فعالة، آمنة، وفورية</span> بين من فقد شيئاً ومن وجده، مما يساهم في بناء الثقة المجتمعية وزيادة إيرادات الشركة من خدمات القيمة المضافة.
                        </p>
                    </div>
                </div>
            </section>
            
            <!-- 2. الأهمية والفائدة المرجوة (للمستخدم والمجتمع) -->
             <section id="importance" class="mb-16">
                 <h2 class="text-3xl font-bold text-center text-[#2196F3] mb-8 border-b-4 border-dashed pb-4">2. الأهمية والفائدة المرجوة (للمستخدم والمجتمع)</h2>
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
                    
                    <div class="kpi-card">
                        <div class="text-5xl mb-3 text-[#2196F3]">🤝</div>
                        <h3 class="xl font-bold text-gray-800 mb-2">تعزيز الثقة المجتمعية</h3>
                        <p class="text-gray-600 text-sm">بناء شبكة من <span style="font-weight: bold;">التعاون والمساعدة المتبادلة</span> بين أفراد المجتمع، مما ينمي الشعور بالأمان والمسؤولية المشتركة.</p>
                    </div>
                    
                    <div class="kpi-card">
                        <div class="text-5xl mb-3 text-[#F44336]">🚀</div>
                        <h3 class="xl font-bold text-gray-800 mb-2">سرعة وفعالية عالية</h3>
                        <p class="text-gray-600 text-sm">الوصول <span style="font-weight: bold;">الفوري لآلاف المشتركين</span> في منطقة الفقدان يزيد من احتمالية العثور على المفقودات خلال ساعات قليلة.</p>
                    </div>
                    
                    <div class="kpi-card">
                        <div class="text-5xl mb-3 text-[#4CAF50]">🛡️</div>
                        <h3 class="xl font-bold text-gray-800 mb-2">أمان وحفظ الخصوصية</h3>
                        <p class="text-gray-600 text-sm">يتم التواصل عبر <span style="font-weight: bold;">وسيط من الشركة</span>، مما يضمن عدم الكشف عن أرقام هواتف الأطراف المعنية ويحمي خصوصيتهم.</p>
                    </div>
                    
                    <div class="kpi-card">
                        <div class="text-5xl mb-3 text-[#673AB7]">🌍</div>
                        <h3 class="xl font-bold text-gray-800 mb-2">تغطية جغرافية واسعة</h3>
                        <p class="text-gray-600 text-sm">إمكانية <span style="font-weight: bold;">الاشتراك في محافظة محددة أو في جميع المحافظات</span> لتوسيع نطاق البحث والبلاغات.</p>
                    </div>
                    
                     <div class="kpi-card">
                        <div class="text-5xl mb-3 text-[#FFC107]">📈</div>
                        <h3 class="xl font-bold text-gray-800 mb-2">خدمة ذات قيمة مضافة</h3>
                        <p class="text-gray-600 text-sm">تقديم خدمة مبتكرة تلبي حاجة حقيقية لدى العملاء، مما يعزز من مكانة شركة الاتصالات كمزود لخدمات نوعية.</p>
                    </div>
                    
                    <div class="kpi-card">
                        <div class="text-5xl mb-3 text-[#00BCD4]">💡</div>
                        <h3 class="xl font-bold text-gray-800 mb-2">سهولة الاستخدام</h3>
                        <p class="text-gray-600 text-sm"><span style="font-weight: bold;">لا تتطلب هواتف ذكية أو إنترنت</span>، فقط عبر الرسائل القصيرة المتاحة لجميع شرائح المجتمع.</p>
                    </div>
                </div>
            </section>
            
            <!-- 3. لشركة الاتصالات والدولة (الجانب التجاري) -->
            <section id="commercial-value" class="mb-16 bg-blue-50 p-8 rounded-xl shadow-md border-r-8 border-[#2196F3]">
                <h2 class="text-3xl font-bold text-[#2196F3] mb-8 pr-4 text-right">3. لشركة الاتصالات والدولة (الجانب التجاري)</h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="commercial-card">
                        <h3 class="xl font-bold text-gray-800 mb-2">💰 زيادة الإيرادات (نموذج MT)</h3>
                        <p class="text-gray-600 text-sm text-right">تحقيق <span style="font-weight: bold;">إيرادات مستدامة</span> لشركة الاتصالات عبر نموذج مزدوج (Subscription/MT): رسوم اشتراك شهري رمزي (<span style="font-weight: bold;">150 ريال يمني</span>) ورسوم على كل عملية بث ناجحة (<span style="font-weight: bold;">100 ريال يمني</span>). هذا النموذج يضمن إيراداً ثابتاً وتغطية لتكاليف الرسائل الجماعية.</p>
                    </div>
                    
                    <div class="commercial-card">
                        <h3 class="xl font-bold text-gray-800 mb-2">🥇 ميزة تنافسية</h3>
                        <p class="text-gray-600 text-sm text-right">تعتبر الخدمة <span style="font-weight: bold;">ميزة تنافسية فريدة</span> حيث لا يوجد خدمات مشابهة مباشرة تعمل عبر الرسائل القصيرة في السوق المحلي، مما يجعل شركتكم الرائدة في هذا المجال.</p>
                    </div>
                    
                    <div class="commercial-card">
                        <h3 class="xl font-bold text-gray-800 mb-2">⭐ تحسين الصورة المؤسسية</h3>
                        <p class="text-gray-600 text-sm text-right">إظهار الشركة كجزء فاعل في نسيج المجتمع ومهتمة بتقديم خدمات ذات <span style="font-weight: bold;">قيمة مجتمعية حقيقية</span>، مما يعزز الولاء للعلامة التجارية.</p>
                    </div>
                    
                    <div class="commercial-card">
                        <h3 class="xl font-bold text-gray-800 mb-2">🤝 فرص الشراكة</h3>
                        <p class="text-gray-600 text-sm text-right">إمكانية عقد <span style="font-weight: bold;">شراكات مستقبلية مع الجهات الحكومية</span> (الشرطة، الأحوال المدنية) والمؤسسات العامة لتسهيل الإبلاغ عن الوثائق الرسمية والمفقودات.</p>
                    </div>
                </div>
            </section>
            
            <!-- 4. آلية عمل الخدمة (رحلة المستخدم) -->
            <section id="mechanism" class="mb-16">
                <h2 class="text-3xl font-bold text-center text-[#2196F3] mb-10 border-r-4 border-[#2196F3] pr-4 text-right">4. آلية عمل الخدمة (رحلة المستخدم)</h2>
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-6 gap-6">
                    
                    <div class="flowchart-step">
                        <div class="flowchart-icon" style="color:#2196F3;">📱</div>
                        <h3 class="lg font-bold text-gray-800">1. الاشتراك</h3>
                        <p class="text-sm text-gray-500">يرسل المستخدم اسم محافظته (مثال: "صنعاء") أو كلمة <span style="font-weight: bold;">"جميع"</span> للاشتراك في كل المحافظات إلى الرقم المخصص.</p>
                    </div>
                     <div class="flowchart-step">
                        <div class="flowchart-icon" style="color:#FFC107;">📝</div>
                        <h3 class="lg font-bold text-gray-800">2. الإبلاغ</h3>
                        <p class="text-sm text-gray-500">عند فقدان شيء، يرسل المشترك <span style="font-weight: bold;">"مفقود"</span> متبوعة بتفاصيل المفقود ومكان فقدانه.</p>
                    </div>
                    <div class="flowchart-step flowchart-step-ai">
                        <div class="flowchart-icon" style="color:#4CAF50;">🔍</div>
                        <h3 class="lg font-bold text-gray-800">3. التحليل الذكي</h3>
                        <p class="text-sm text-gray-500">يقوم <span style="font-weight: bold;">الذكاء الاصطناعي</span> بتحليل وتصنيف وتنقيح البلاغ وتقييم أولويته.</p>
                    </div>
                    <div class="flowchart-step">
                        <div class="flowchart-icon" style="color:#F44336;">🧑‍💻</div>
                        <h3 class="lg font-bold text-gray-800">4. المراجعة</h3>
                        <p class="text-sm text-gray-500">يقوم موظف بمراجعة البلاغ للتأكد من مطابقته للشروط، ثم الموافقة على بثه لجميع المشتركين في النطاق المحدد.</p>
                    </div>
                     <div class="flowchart-step">
                        <div class="flowchart-icon" style="color:#673AB7;">📥</div>
                        <h3 class="lg font-bold text-gray-800">5. الاستلام والبث</h3>
                        <p class="text-sm text-gray-500">يستقبل المشتركون رسالة البلاغ. إذا كان مشتركاً في "جميع" المحافظات، ستتضمن الرسالة اسم المحافظة التي فُقد فيها الغرض.</p>
                    </div>
                     <div class="flowchart-step">
                        <div class="flowchart-icon" style="color:#00BCD4;">📞</div>
                        <h3 class="lg font-bold text-gray-800">6. التواصل الآمن</h3>
                        <p class="text-sm text-gray-500">عند العثور على المفقود، يتم التواصل مع <span style="font-weight: bold;">رقم الخدمة</span>، ويقوم الموظف بتنسيق عملية التسليم بأمان وسرية تامة.</p>
                    </div>
                </div>
            </section>
            
            <!-- 5. جاهزية النظام والتوقعات -->
            <section id="readiness-and-forecast" class="mb-16 bg-white p-8 rounded-xl shadow-lg border-r-8 border-[#2196F3]">
                <h2 class="text-3xl font-bold text-[#2196F3] mb-8 pr-4 text-right">5. جاهزية النظام والتوقعات</h2>
                
                <div class="md:col-span-2">
                    <h3 class="2xl font-bold text-gray-800 mb-4 border-b pb-2">النظام جاهز للإطلاق الفوري</h3>
                    <ul class="list-disc pr-5 space-y-3 text-gray-700 text-right">
                        <li><span style="font-weight: bold;">منصة تقنية متكاملة:</span> البنية التحتية جاهزة لإدارة الاشتراكات، استقبال البلاغات، وتنفيذ عمليات البث بكفاءة.</li>
                        <li><span style="font-weight: bold;">لوحة تحكم للموظفين:</span> واجهة عمل سهلة وفعالة لمراجعة البلاغات والموافقة عليها بسهولة وكفاءة.</li>
                        <li><span style="font-weight: bold;">قاعدة بيانات آمنة:</span> لضمان حماية بيانات المشتركين والالتزام بأعلى معايير الخصوصية.</li>
                        <li><span style="font-weight: bold;">نموذج تسعير مدروس:</span> تشغيل الخدمة على MT و MO، مع:
                            <ul class="list-circle pr-5 space-y-1 mt-1 font-semibold text-[#2196F3]">
                                <li>اشتراك شهري رمزي: 150 ريال.</li>
                                <li>تكلفة بث البلاغ: 100 ريال.</li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </section>
            
            <!-- 6. القيمة المضافة للذكاء الاصطناعي (Gemini API) -->
            <section id="ai-value" class="mb-16 bg-green-50 p-8 rounded-xl shadow-lg border-r-8 border-[#4CAF50]">
                <h2 class="text-3xl font-bold text-[#4CAF50] mb-8 pr-4 text-right">6. القيمة المضافة للذكاء الاصطناعي (Gemini API)</h2>
                <p class="text-gray-700 mb-8 text-right">دمج الذكاء الاصطناعي ينقل خدمة "مفقوداتي" من خدمة تقليدية إلى منصة <span style="font-weight: bold;">ذكية عالية الكفاءة</span> وقابلة للتوسع.</p>
                
                <!-- المقارنة بين الطريقتين -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-10">
                    
                    <!-- الطريقة التقليدية -->
                    <div class="comparison-card traditional p-6 border-t-4 border-[#F44336] shadow-xl">
                        <h4 class="text-xl font-bold text-[#F44336] mb-4 flex items-center">
                            <span class="icon ml-2">🕰️</span> الطريقة التقليدية (بدون ذكاء اصطناعي)
                        </h4>
                        <ul class="text-sm text-gray-700 space-y-3 pr-4">
                            <li class="comparison-point traditional-point"><span style="font-weight: bold;">استقبال بلاغ خام:</span> بنص غير منظم ويصعب تحليله.</li>
                            <li class="comparison-point traditional-point"><span style="font-weight: bold;">مراجعة يدوية مملة:</span> يقرأ الموظف النص كاملاً ليفهمه.</li>
                            <li class="comparison-point traditional-point"><span style="font-weight: bold;">تصنيف وتحليل يدوي:</span> يحدد الموظف نوع المفقود والموقع.</li>
                            <li class="comparison-point traditional-point"><span style="font-weight: bold;">إعادة صياغة يدوية:</span> يكتب الموظف رسالة البث بنفسه.</li>
                            <li class="comparison-point traditional-point"><span style="font-weight: bold;">النتيجة:</span> عملية بطيئة، عرضة للأخطاء البشرية، ومكلفة تشغيلياً مع زيادة عدد البلاغات.</li>
                        </ul>
                    </div>
                    
                    <!-- الطريقة المعززة بالذكاء الاصطناعي -->
                     <div class="comparison-card traditional p-6 border-t-4 border-[#4CAF50] shadow-xl">
                        <h4 class="text-xl font-bold text-[#4CAF50] mb-4 flex items-center">
                            <span class="icon ml-2">✨</span> الطريقة المعززة بالـ Gemini AI
                        </h4>
                        <ul class="text-sm text-gray-700 space-y-3 pr-4">
                            <li class="comparison-point ai-point"><span style="font-weight: bold;">تحليل فوري وتصنيف:</span> يقوم Gemini بتحليل النص واستخراج وتصنيف نوع المفقود والموقع (حتى لو لم يُذكر صراحة).</li>
                            <li class="comparison-point ai-point"><span style="font-weight: bold;">تنظيم أولوية وتجميع:</span> يُقيّم الذكاء الاصطناعي التكرار لتجنب <span style="font-weight: bold;">إزعاج المشتركين</span> ويوحد الرسائل المتشابهة.</li>
                            <li class="comparison-point ai-point"><span style="font-weight: bold;">التوسع التجاري السريع:</span> يولد محتوى تسويقي فوري لفئات الخدمات ذات القيمة المضافة (VAS) الجديدة ليفتح <span style="font-weight: bold;">مسارات إيرادات</span>.</li>
                            <li class="comparison-point ai-point"><span style="font-weight: bold;">التنقيح:</span> رسالة بث جاهزة وموحدة بضغطة زر.</li>
                            <li class="comparison-point ai-point"><span style="font-weight: bold;">النتيجة:</span> كفاءة عالية، خفض التكاليف التشغيلية، وتسريع التوسع التجاري.</li>
                        </ul>
                    </div>
                </div>

                <!-- مخطط توفير التكاليف -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mt-10">
                    <div class="md:col-span-1 p-4">
                        <h3 class="2xl font-bold text-gray-800 mb-4 border-b pb-2 text-center">مخطط توفير التكاليف (بفضل الذكاء الاصطناعي)</h3>
                        <div class="chart-container">
                            <canvas id="costChart"></canvas>
                        </div>
                         <p class="text-center text-sm text-gray-600 mt-2">يوضح المخطط أن التحليل الذكي يقلل من حاجة الموظفين لمراجعة البلاغات بشكل يدوي، مما يوفر 40% من التكاليف التشغيلية.</p>
                    </div>
                    
                     <!-- مركز الذكاء الاصطناعي التفاعلي -->
                    <div class="md:col-span-1 p-6 rounded-xl shadow-2xl border border-blue-400 ai-demo-container">
                        <h3 class="text-3xl font-bold text-[#2196F3] mb-2 text-center">مركز الذكاء الاصطناعي التفاعلي (دليل عملي)</h3>
                        <p class="text-md text-gray-700 mb-6 text-center">تجربة حية لكيفية استخدام محرك Gemini في تسريع العمليات التشغيلية والتجارية.</p>
                        
                        <div class="flex justify-center mb-6 border-b-2 border-blue-300">
                            <button id="tab1" onclick="showTab('analysis')" class="tab-button px-6 py-3 text-lg border-b-2 border-transparent text-gray-600 hover:text-[#4CAF50] hover:border-[#4CAF50]">
                                🤖 التحليل التشغيلي
                            </button>
                            <button id="tab2" onclick="showTab('expansion')" class="tab-button px-6 py-3 text-lg border-b-2 border-transparent text-gray-600 hover:text-[#2196F3] hover:border-[#2196F3]">
                                💰 التوسع التجاري (VAS)
                            </button>
                        </div>

                        <div id="analysisContent" class="space-y-6 bg-white p-6 rounded-lg shadow-md border-t-4 border-[#4CAF50]">
                            <h4 class="xl font-bold text-[#4CAF50]">المهمة: تحليل بلاغ SMS خام</h4>
                            <div class="mb-4">
                                <label for="rawInput" class="block text-right text-gray-700 font-medium mb-1">نص البلاغ الخام:</label>
                                <textarea id="rawInput" rows="3" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-[#4CAF50] focus:border-[#4CAF50] transition duration-150 text-right resize-none" placeholder="مثال: ضاعت مني محفظة بنية كبيرة فيها بطاقتي وبعض الفلوس، كانت في سوق الحمرا."></textarea>
                            </div>
                            
                            <button onclick="analyzeReport()" id="analyzeButton" class="w-full py-3 bg-[#4CAF50] hover:bg-[#388E3C] text-white font-bold rounded-lg transition duration-300 shadow-lg transform hover:scale-[1.01]">
                                ✨ تحليل وتنقيح البلاغ (AI Powered)
                            </button>

                            <div id="aiOutput" class="mt-6 border-t border-gray-300 pt-4 hidden">
                                <h4 class="xl font-bold text-gray-800 mb-3 border-b pb-2">نتائج التحليل الذكي:</h4>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div><span style="font-weight: bold; color: #2196F3;">تصنيف الغرض:</span> <span id="outputCategory" class="font-medium text-gray-700"></span></div>
                                    <div><span style="font-weight: bold; color: #2196F3;">المحافظة المستخلصة:</span> <span id="outputGovernorate" class="font-medium text-gray-700"></span></div>
                                    <div><span style="font-weight: bold; color: #2196F3;">الموقع المستخرج:</span> <span id="outputLocation" class="font-medium text-gray-700"></span></div>
                                    <div><span style="font-weight: bold; color: #2196F3;">توصية الأولوية/التوحيد:</span> <span id="outputPriority" class="font-medium text-gray-700"></span></div>
                                    <div class="md:col-span-2">
                                        <span style="font-weight: bold; color: #2196F3;">رسالة البث المنقحة (SMS):</span> 
                                        <p id="outputRefined" class="mt-1 p-3 bg-blue-50 border border-blue-200 rounded-lg text-lg font-semibold text-gray-800"></p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="expansionContent" class="space-y-6 hidden bg-white p-6 rounded-lg shadow-md border-t-4 border-[#2196F3]">
                             <h4 class="xl font-bold text-[#2196F3]">المهمة: توليد محتوى لفئة VAS جديدة</h4>
                             <div class="mb-4">
                                <label for="newCategoryInput" class="block text-right text-gray-700 font-medium mb-1">اسم الفئة الجديدة المقترحة:</label>
                                <input type="text" id="newCategoryInput" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-[#2196F3] focus:border-[#2196F3] transition duration-150 text-right" placeholder="مثال: وظائف صغيرة، بيع أغراض مستعملة">
                            </div>
                            
                            <button onclick="generateNewCategory()" id="generateCategoryButton" class="w-full py-3 bg-[#2196F3] hover:bg-[#1976D2] text-white font-bold rounded-lg transition duration-300 shadow-lg transform hover:scale-[1.01]">
                                ✨ توليد محتوى الفئة (AI Powered)
                            </button>
                            
                            <div id="categoryOutput" class="mt-6 border-t border-gray-300 pt-4 hidden">
                                <h4 class="xl font-bold text-gray-800 mb-3 border-b pb-2">مقترح المحتوى والتسعير:</h4>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                     <div class="md:col-span-2"><span style="font-weight: bold; color: #4CAF50;">الوصف التسويقي:</span> <span id="outputCategoryDescription" class="font-medium text-gray-700"></span></div>
                                     <div class="md:col-span-2"><span style="font-weight: bold; color: #4CAF50;">رسالة الاشتراك المقترحة:</span> <span id="outputCategorySMS" class="font-medium text-gray-700"></span></div>
                                     <div><span style="font-weight: bold; color: #4CAF50;">رسوم البث المقترحة:</span> <span id="outputCategoryPrice" class="font-medium text-gray-700"></span></div>
                                </div>
                            </div>
                        </div>
                         <div id="loadingIndicator" class="text-center mt-4 hidden text-[#4CAF50] font-bold">
                            جاري معالجة طلبك... يرجى الانتظار 🚀
                        </div>
                        <div id="errorIndicator" class="text-center mt-4 hidden text-[#F44336] font-bold">
                            ⚠️ حدث خطأ أثناء الاتصال بالذكاء الاصطناعي.
                        </div>
                    </div>
                </div>
            </section>
            
        </main>

        <footer class="text-center mt-12 py-6 border-t border-gray-300">
            <p class="text-gray-600">نقدم لكم خدمة "مفقوداتي" كحل رائد ومستقبلي، يجمع بين الوصول المجتمعي وقوة الذكاء الاصطناعي. نتطلع بثقة لموافقتكم الكريمة لإطلاق هذه الخدمة النوعية.</p>
        </footer>
    </div>

    <script>
        
        const initializeCharts = () => {
             // Chart for Cost Savings
            const costCtx = document.getElementById('costChart').getContext('2d');
            const costChart = new Chart(costCtx, {
                type: 'doughnut',
                data: {
                    labels: ['تكاليف المراجعة اليدوية', 'التكاليف الموفرة بفضل الـ AI'],
                    datasets: [{
                        data: [60, 40],
                        backgroundColor: ['#F44336', '#4CAF50'],
                        hoverOffset: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        tooltip: {
                             callbacks: {
                                title: function(tooltipItems) {
                                    const item = tooltipItems[0];
                                    let label = item.chart.data.labels[item.dataIndex];
                                    if (Array.isArray(label)) {
                                      return label.join(' ');
                                    } else {
                                      return label;
                                    }
                                },
                                label: function(context) {
                                    return context.label + ': ' + context.raw + '%';
                                }
                            }
                        }
                    }
                }
            });
            
            // Show analysis tab by default
             showTab('analysis');
        };
        
        document.addEventListener('DOMContentLoaded', initializeCharts);


        const showTab = (tabName) => {
            document.getElementById('analysisContent').classList.add('hidden');
            document.getElementById('expansionContent').classList.add('hidden');
            document.getElementById('tab1').classList.remove('active');
            document.getElementById('tab2').classList.remove('active');
            
            if (tabName === 'analysis') {
                document.getElementById('analysisContent').classList.remove('hidden');
                document.getElementById('tab1').classList.add('active');
            } else if (tabName === 'expansion') {
                document.getElementById('expansionContent').classList.remove('hidden');
                document.getElementById('tab2').classList.add('active');
            }
        };

        const callGeminiApi = async (payload) => {
            const apiKey = ""; 
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;
            
            let result;
            let attempt = 0;
            const maxAttempts = 5;
            const baseDelay = 1000;

            while (attempt < maxAttempts) {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (response.status === 429) {
                    attempt++;
                    const delay = baseDelay * Math.pow(2, attempt) + Math.random() * 1000;
                    if (attempt < maxAttempts) {
                        await new Promise(resolve => setTimeout(resolve, delay));
                        continue;
                    } else {
                        throw new Error("API rate limit exceeded after multiple retries.");
                    }
                }

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                result = await response.json();
                break;
            }
            return result;
        };
        
        const analyzeReport = async () => {
            const rawInput = document.getElementById('rawInput').value.trim();
            const loadingIndicator = document.getElementById('loadingIndicator');
            const aiOutputDiv = document.getElementById('aiOutput');
            const errorIndicator = document.getElementById('errorIndicator');
            const analyzeButton = document.getElementById('analyzeButton');

            aiOutputDiv.classList.add('hidden');
            errorIndicator.classList.add('hidden');

            if (!rawInput) {
                alert('الرجاء إدخال نص البلاغ أولاً.');
                return;
            }

            analyzeButton.disabled = true;
            loadingIndicator.classList.remove('hidden');

            const systemPrompt = "أنت محترف في تحليل بلاغات المفقودات الواردة عبر الرسائل القصيرة. مهمتك هي استخراج البيانات الهامة من النص الخام وتنقيحه ليصبح رسالة بث قصيرة ومقنعة (SMS). يجب أن يكون الإخراج بصيغة JSON وفقاً للمخطط المحدد. قم باستخلاص المحافظة أو استنتاجها وتحديد المحافظة الأقرب أو الأرجح بناءً على الموقع المستخرج في حال لم يذكرها المستخدم. بناءً على طبيعة المفقود والتفاصيل المقدمة، قم بتحديد أولوية البث.";
            const userQuery = `حلل البلاغ التالي: "${rawInput}"`;
            
            const responseSchema = {
                type: "OBJECT",
                properties: {
                    "item_category": { "type": "STRING", "description": "تصنيف الغرض المفقود (مثل: محفظة، هاتف، مفاتيح، وثيقة رسمية)." },
                    "governorate_extracted": { "type": "STRING", "description": "اسم المحافظة المستخلصة أو المُستنتجة بناءً على الموقع (مثال: صنعاء، عدن). في حال عدم ذكرها أو عدم القدرة على الاستدلال، ضع قيمة 'غير محددة'." },
                    "location_extracted": { "type": "STRING", "description": "الموقع الجغرافي الذي تم فيه الفقدان (مثل: شارع، حي، مجمع)." },
                    "priority_recommendation": { "type": "STRING", "description": "توصية الأولوية للبث (مثال: بث فوري وعاجل، توحيد مع بلاغ آخر لتجنب الإزعاج، أولوية منخفضة)." },
                    "refined_message": { "type": "STRING", "description": "رسالة البث المُعاد صياغتها، يجب أن تكون قصيرة، واضحة، وجذابة لإرسالها عبر SMS (لا تزيد عن 160 حرفاً)." }
                },
                required: ["item_category", "governorate_extracted", "location_extracted", "priority_recommendation", "refined_message"]
            };

            const payload = {
                contents: [{ parts: [{ text: userQuery }] }],
                systemInstruction: { parts: [{ text: systemPrompt }] },
                generationConfig: {
                    responseMimeType: "application/json",
                    responseSchema: responseSchema
                }
            };

            try {
                const result = await callGeminiApi(payload);

                const jsonText = result?.candidates?.[0]?.content?.parts?.[0]?.text;
                if (jsonText) {
                    const parsedJson = JSON.parse(jsonText);
                    document.getElementById('outputCategory').textContent = parsedJson.item_category || 'غير محدد';
                    document.getElementById('outputGovernorate').textContent = parsedJson.governorate_extracted || 'غير محددة';
                    document.getElementById('outputLocation').textContent = parsedJson.location_extracted || 'غير محدد';
                    document.getElementById('outputPriority').textContent = parsedJson.priority_recommendation || 'غير محدد';
                    document.getElementById('outputRefined').textContent = parsedJson.refined_message || 'لم يتم التنقيح';
                    aiOutputDiv.classList.remove('hidden');
                } else {
                    throw new Error("Invalid response structure from Gemini API.");
                }

            } catch (error) {
                console.error("Gemini API Error:", error);
                errorIndicator.classList.remove('hidden');
            } finally {
                loadingIndicator.classList.add('hidden');
                analyzeButton.disabled = false;
            }
        };

        const generateNewCategory = async () => {
            const categoryInput = document.getElementById('newCategoryInput').value.trim();
            const loadingIndicator = document.getElementById('loadingIndicator');
            const categoryOutputDiv = document.getElementById('categoryOutput');
            const errorIndicator = document.getElementById('errorIndicator');
            const generateCategoryButton = document.getElementById('generateCategoryButton');

            categoryOutputDiv.classList.add('hidden');
            errorIndicator.classList.add('hidden');

            if (!categoryInput) {
                alert('الرجاء إدخال اسم الفئة الجديدة أولاً.');
                return;
            }

            generateCategoryButton.disabled = true;
            loadingIndicator.classList.remove('hidden');

            const systemPrompt = "أنت خبير تسويق خدمات ذات قيمة مضافة (VAS) عبر الرسائل القصيرة. مهمتك هي توليد محتوى تسويقي مقنع ومناسب للرسائل القصيرة لفئة خدمة جديدة، مع اقتراح تسعيرة منطقية بناءً على القيمة.";
            const userQuery = `قم بتوليد وصف تسويقي، ورسالة اشتراك قصيرة، واقتراح سعر معقول لرسالة بث واحدة للفئة الجديدة: "${categoryInput}". يجب استخدام الريال اليمني في التسعير.`;
            
            const responseSchema = {
                type: "OBJECT",
                properties: {
                    "marketing_description": { "type": "STRING", "description": "وصف تسويقي مقنع للفئة الجديدة لا يتجاوز 100 حرف." },
                    "sms_subscription_message": { "type": "STRING", "description": "رسالة قصيرة ومقنعة للاشتراك في الفئة الجديدة (SMS) لا تتجاوز 160 حرفاً)." },
                    "broadcast_price_suggestion": { "type": "STRING", "description": "اقتراح سعر البث لمرة واحدة للرسالة الواحدة في هذه الفئة بالريال اليمني (مثال: 200 ريال يمني)." }
                },
                required: ["marketing_description", "sms_subscription_message", "broadcast_price_suggestion"]
            };

            const payload = {
                contents: [{ parts: [{ text: userQuery }] }],
                systemInstruction: { parts: [{ text: systemPrompt }] },
                generationConfig: {
                    responseMimeType: "application/json",
                    responseSchema: responseSchema
                }
            };

            try {
                const result = await callGeminiApi(payload);

                const jsonText = result?.candidates?.[0]?.content?.parts?.[0]?.text;
                if (jsonText) {
                    const parsedJson = JSON.parse(jsonText);
                    document.getElementById('outputCategoryDescription').textContent = parsedJson.marketing_description || 'غير محدد';
                    document.getElementById('outputCategorySMS').textContent = parsedJson.sms_subscription_message || 'غير محدد';
                    document.getElementById('outputCategoryPrice').textContent = parsedJson.broadcast_price_suggestion || 'غير محدد';
                    categoryOutputDiv.classList.remove('hidden');
                } else {
                    throw new Error("Invalid response structure from Gemini API.");
                }

            } catch (error) {
                console.error("Gemini API Error:", error);
                errorIndicator.classList.remove('hidden');
            } finally {
                loadingIndicator.classList.add('hidden');
                generateCategoryButton.disabled = false;
            }
        };
    </script>
</body>
</html>
